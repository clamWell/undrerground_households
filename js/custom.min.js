function sendSns(e){var t=encodeURIComponent(location.href),a=encodeURIComponent($("title").html());switch(e){case"facebook":window.open("http://www.facebook.com/sharer/sharer.php?u="+t);break;case"twitter":window.open("http://twitter.com/intent/tweet?text="+a+"&url="+t)}}$(function(){var e=$(window).width(),t=$(window).height(),a="http://img.khan.co.kr/spko/storytelling/2020/underground/",l=e<=800;window.onbeforeunload=function(){window.scrollTo(0,0)};var r,n,c,d=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};function p(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function h(t){if("all_city"==t)$("#POLE_CHART_SWIFT .click-animation").hide(),d3.selectAll("#ALL_CITY_HOUSE_POLE .pole").transition().duration(500).style("display",null).style("opacity","1").attr("width",r),d3.selectAll("#ALL_CITY_HOUSE_POLE .pole-g").transition().duration(500).attr("transform",function(e,t){return"translate("+t*(r+c)+",0)"}),d3.selectAll(".area-box").style("opacity","1"),d3.selectAll(".pole-label").style("display","none");else if("only_centre"==t){$("#POLE_CHART_SWIFT .click-animation").fadeIn(),d3.selectAll("#ALL_CITY_HOUSE_POLE .pole").filter(function(e){return!("서울시"==e.geoWide||"경기도"==e.geoWide||"인천시"==e.geoWide)}).style("display","none").style("opacity","0"),d3.selectAll(".area-box").style("opacity","0");n=((e<1300?e-80:1300)-10)/66-(c=2),d3.selectAll("#ALL_CITY_HOUSE_POLE .pole-g").filter(function(e){return"서울시"==e.geoWide||"경기도"==e.geoWide||"인천시"==e.geoWide}).transition().duration(500).attr("transform",function(e,t){return"translate("+t*(n+c)+", 0)"}),d3.selectAll("#ALL_CITY_HOUSE_POLE .pole").filter(function(e){return"서울시"==e.geoWide||"경기도"==e.geoWide||"인천시"==e.geoWide}).transition().duration(500).attr("width",n),d3.selectAll(".pole-label").filter(function(e){return("서울시"==e.geoWide||"경기도"==e.geoWide||"인천시"==e.geoWide)&&Number(e.under_house_ratio)>1}).style("display","inline")}}$(window).resize(function(){e=$(window).width(),t=$(window).height()}),$(window).scroll(function(){$(window).scrollTop()}),function(){var t=all_city_data,a=t.map(function(e){return Number(e.under_house)}),o=d3.max(a),n=(d3.min(a),d3.select("#ALL_CITY_HOUSE_POLE").select("svg"));if(n.append("pattern").attr("id","diagonalHatchArea").attr("patternUnits","userSpaceOnUse").attr("width",4).attr("height",4).append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2").attr("stroke","#333").attr("stroke-width",1),1==l){15;var s=e-70;_=(15+(c=3))*t.length;var i=s/o;n.attr("width",s+"px").attr("height",_+"px").attr("transform","translate(10, 0)");var d=n.append("g").attr("class","chart-holder"),u=d3.scale.linear().range([0,s]).domain([0,o]),h=d3.scale.linear().range([0,_]),f=d3.svg.axis().scale(u).orient("top").ticks(5);d.append("g").attr("class","x axis").attr("transform","translate(0,-10)").call(f),(g=d.append("g").attr("class","area-box centre-area")).append("rect").style("fill",function(e){return"url(#diagonalHatchArea)"}).attr("height",66*(15+c)).attr("width",s).attr("class","area-rect centre-area-rect").style("fill-opacity","0.15"),g.append("text").text("수도권").attr("class","area-label").attr("transform","translate("+s+",10)"),(y=d.append("g").attr("class","area-box seoul-area")).append("rect").style("fill",function(e){return"rgb(187, 187, 187)"}).attr("width",.8*s).attr("height",25*(15+c)).attr("x","0").attr("y","0").attr("class","area-rect seoul-area-rect").style("fill-opacity","0.2"),y.append("text").text("서울").attr("class","area-label").attr("transform","translate("+.75*s+",10)"),(m=d.append("g").attr("class","pole-under-house-holder").selectAll("g").data(t).enter().append("g").attr("class","pole-g").attr("transform",function(e,t){return"translate(0,"+t*(15+c)+")"})).append("rect").style("fill",function(e){return"#ffae12"}).attr("height",15).attr("class","pole pole-under-house").attr("width",function(e){var t=Number(e.under_house)*i;return t<4&&(t=4),t}).attr("x","0").attr("y","0"),m.append("rect").style("fill",function(e){return"#ff432f"}).attr("height",15).attr("class","pole pole-under-single-house").attr("width",function(e){return Number(e.under_house_single)*i}).attr("x","0").attr("y","0"),m.append("text").attr("class","pole-label").text(function(e){return e.under_house+"가구("+e.under_house_ratio+"%)"}).attr("transform",function(e,t){var a=Number(e.under_house)*i;return a>=s-60&&(a=s-60),"translate("+a+",11)"}),d.append("g").attr("class","label-holder").attr("transform","translate(0, 10)").selectAll("g").data(t).enter().append("g").attr("transform",function(e,t){return"translate(-35,"+t*(15+c)+")"}).append("text").attr("width","30").attr("fill","#111").attr("font-size","10px").attr("class","graph-Xaxis").attr("text-anchor","start").text(function(e){return e.geo}),(x=$(".all-city-household-chart .tooltip")).css({opacity:"0"}),m.on("click",function(e){d3.selectAll("#ALL_CITY_HOUSE_POLE .pole").style("fill-opacity","0.4"),d3.select(this).selectAll(".pole").style("fill-opacity","1").style("stroke","#7b0000").style("stroke-width","1px"),x.css({opacity:"1"}),x.css({display:"block"}),x.find(".city-name").html(e.geoWide+" "+e.geo),x.find(".household .value").html(p(e.house)),x.find(".under-household .value").html(p(e.under_house)),x.find(".under-household-single .value").html(p(e.under_house_single)),x.find(".under-household-ratio .value").html(e.under_house_ratio),d3.select(this).selectAll(".pole-label").style("opacity","1")}).on("mouseleave",function(e){d3.selectAll("#ALL_CITY_HOUSE_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),x.css({opacity:"0"}),x.css({display:"none"}),d3.selectAll(".pole-label").style("opacity",null)}),$(".story-body:not(#ALL_CITY_HOUSE_POLE)").on("touchstart",function(){d3.selectAll("#ALL_CITY_HOUSE_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),x.css({opacity:"0"}),x.css({display:"none"}),d3.selectAll(".pole-label").style("opacity",null)})}else{s=e<1300?e-80:1300;var _=400;n.attr("width",s+"px").attr("height",_+"px"),d=n.append("g").attr("class","chart-holder"),u=d3.scale.linear().range([0,s]),h=d3.scale.linear().range([_,0]).domain([0,o]);var g,y,m,x,v=d3.svg.axis().scale(h).orient("left").ticks(5);i=_/o,c=2,r=(s-10)/t.length-c,d.append("g").attr("class","y axis").attr("transform","translate(-10,0)").call(v),(g=d.append("g").attr("class","area-box centre-area")).append("rect").style("fill",function(e){return"url(#diagonalHatchArea)"}).attr("width",66*(r+c)).attr("height",_).attr("class","area-rect centre-area-rect").style("fill-opacity","0.15"),g.append("text").text("수도권").attr("class","area-label").attr("transform","translate("+33*(r+c)+",20)"),(y=d.append("g").attr("class","area-box seoul-area")).append("rect").style("fill",function(e){return"rgb(255, 183, 183)"}).attr("width",25*(r+c)).attr("height",.8*_).attr("x","0").attr("y",.2*_).attr("class","area-rect seoul-area-rect").style("fill-opacity","0"),y.append("text").text("서울").attr("class","area-label").attr("transform","translate("+12*(r+c)+","+.2*_+")"),$(".item.one").insertAfter(".item.three"),(m=d.append("g").attr("class","pole-under-house-holder").selectAll("g").data(t).enter().append("g").attr("class","pole-g").attr("transform",function(e,t){return"translate("+t*(r+c)+",0)"})).append("rect").style("fill",function(e){return"#ffae12"}).attr("width",r).attr("class","pole pole-under-house").attr("height",function(e){var t=Number(e.under_house)*i;return t<4&&(t=4),t}).attr("x",function(e,t){return 0}).attr("y",function(e){var t=Number(e.under_house)*i;return t<4&&(t=4),_-t}),m.append("rect").style("fill",function(e){return"#ff432f"}).attr("width",r).attr("class","pole pole-under-single-house").attr("height",function(e){return Number(e.under_house_single)*i}).attr("x",function(e,t){return 0}).attr("y",function(e){return _-Number(e.under_house_single)*i}),m.append("text").attr("class","pole-label").text(function(e){return e.under_house_ratio+"%"}).attr("transform",function(e,t){return"translate(8,"+(_-Number(e.under_house)*i-2)+")"}).style("display","none"),(x=$(".all-city-household-chart .tooltip")).css({opacity:"0"}),m.on("mouseenter",function(e){d3.selectAll("#ALL_CITY_HOUSE_POLE .pole").style("fill-opacity","0.4"),d3.select(this).selectAll(".pole").style("fill-opacity","1").style("stroke","#7b0000").style("stroke-width","1px"),x.css({opacity:"1"}),x.find(".city-name").html(e.geoWide+" "+e.geo),x.find(".household .value").html(p(e.house)),x.find(".under-household .value").html(p(e.under_house)),x.find(".under-household-single .value").html(p(e.under_house_single)),x.find(".under-household-ratio .value").html(e.under_house_ratio),x.css({left:d3.mouse(this.parentNode)[0]+"px"}),x.css({bottom:"-70px"})}).on("mouseleave",function(e){d3.selectAll("#ALL_CITY_HOUSE_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),x.css({opacity:"0"})})}$(".all-city-household-chart .tooltip .close-btn").on("click",function(){d3.selectAll("#ALL_CITY_HOUSE_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),x.css({opacity:"0"}),x.css({display:"none"}),d3.selectAll(".pole-label").style("opacity",null)})}(),$("#POLE_CHART_SWIFT ul").find("li").on("click",function(){$("#POLE_CHART_SWIFT ul li").removeClass("on"),$(this).addClass("on"),h($(this).attr("data-chart-type"))});d=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};function f(t){_();var a=e,r=t,o=Number(r.house)/20,n=o*r.under_house_ratio/100,s=person_path,c=d3.select("#ICON_SPREADING_HOLDER").attr("width",a+"px").attr("height","300px").append("g").attr("class","icon_holder").append("g").attr("class","each-g"),p=1==l?500:1e3;for(o>p&&(o=p,n=p*r.under_house_ratio/100),console.log(o,n),i=0;i<o;i++)c.append("g").attr("class","icon").attr("transform",function(){return"translate("+d(0,a)+","+d(0,300)+")"}).style("width",10).style("height",27).style("opacity","0").append("path").attr("class","icon-path").attr("d",function(e){var t=d(0,17);return s[t].path}).style("fill","url(#iconGrad1)").style("fill-opacity","0.7");for(u=0;u<n;u++){var h=d(0,o);$(".icon-path").eq(h).addClass("iconUnder"),d3.select(".icon:nth-child("+h+")").select("path").style("fill","#ff5200").style("fill-opacity","1")}d3.selectAll(".icon").transition().duration(function(){return Math.floor(3e3*Math.random())}).style("opacity","1")}function _(){d3.select("#ICON_SPREADING_HOLDER").select(".icon_holder").remove()}var g=$("#search-02"),y=$("#search-01"),m=$("#search-03"),x=y.find("option"),v=$("#search-05"),b=$("#search-04"),A=b.find("option");x.sort(function(e,t){return e.text>t.text?1:e.text<t.text?-1:e.value>t.value?1:e.value<t.value?-1:0}),y.html(x),y.prepend("<option value='선택'> 선택 </option>"),y.find("option").eq(0).attr("selected","selected");var E={};function O(){E.selectGeoVote=null,E.selectVote=null,E.selectGeoWide=null,E.selectBase=null,E.selectDong=null,v.addClass("search-btn-block"),$("#search-05 option").remove(),v.append("<option value='선택'> 선택 </option>"),g.addClass("search-btn-block"),$("#search-02 option").remove(),g.append("<option value='선택'> 선택 </option>"),m.addClass("search-btn-block"),$("#search-03 option").remove(),m.append("<option value='선택'> 선택 </option>"),y.find("option").eq(0).attr("selected","selected"),b.find("option").eq(0).attr("selected","selected")}E.selectGeoWide,E.selectBase,E.selectDong,E.appendOpt=function(e){g.find("option").remove();var t,a=e;for(i=0;i<all_dong_data.length;i++)all_dong_data[i].geoWide==a&&(0!==i?t==all_dong_data[i].geo||t!==all_dong_data[i].geo&&(g.append("<option value='"+all_dong_data[i].geo+"'>"+all_dong_data[i].geo+"</option>"),t=all_dong_data[i].geo):0==i&&(g.append("<option value='"+all_dong_data[i].geo+"'>"+all_dong_data[i].geo+"</option>"),t=all_dong_data[i].geo));g.removeClass("search-btn-block");var l=g.find("option");l.sort(function(e,t){return e.text>t.text?1:e.text<t.text?-1:e.value>t.value?1:e.value<t.value?-1:0}),g.html(l),g.prepend("<option value='선택'> 선택 </option>"),g.find("option").eq(0).attr("selected","selected")},E.appendOptDong=function(e){m.find("option").remove();var t=e;for(i=0;i<all_dong_data.length;i++)all_dong_data[i].geoWide==this.selectGeoWide&&all_dong_data[i].geo==t&&m.append("<option value='"+all_dong_data[i].geoD+"'>"+all_dong_data[i].geoD+"</option>");m.removeClass("search-btn-block");var a=m.find("option");a.sort(function(e,t){return e.text>t.text?1:e.text<t.text?-1:e.value>t.value?1:e.value<t.value?-1:0}),m.html(a),m.prepend("<option value='선택'> 선택 </option>"),m.find("option").eq(0).attr("selected","selected")},E.fillResult=function(e,t,a){var l;for(i=0;i<all_dong_data.length;i++)if(all_dong_data[i].geoWide==e&&all_dong_data[i].geo==t&&all_dong_data[i].geoD==a){l=all_dong_data[i];break}$(".geo-exp").html("지역"),$("#SELECT_CITY_NAME").html(l.geoWide+" "+l.geo+" "+l.geoD),$("#SELECT_HOUSE_NUMBER").html(l.house+" 가구"),$("#SELECT_UNDERHOUSE_NUMBER").html(l.under_house+" 가구"),$("#SELECT_UNDERHOUSE_RATIO").html(l.under_house_ratio+"%"),E.showResult(l)},E.showResult=function(e){var t=e;$(".result-text-before").hide(),$(".result-text").slideDown(function(){var e=1==l?100:200,a=$(".search-result-box").offset().top-e;$("html, body").animate({scrollTop:a},1200,"easeOutCubic"),f(t)})},y.on("change",function(){if(E.selectBase=null,E.selectGeoWide=null,E.selectDong=null,0==$(this).children("option:selected").index())return g.addClass("search-btn-block"),$("#search-02 option").remove(),void g.append("<option value='선택'> 선택 </option>");E.appendOpt($(this).val()),E.selectGeoWide=$(this).val()}),g.on("change",function(){if(E.selectBase=null,E.selectDong=null,0==$(this).children("option:selected").index())return m.addClass("search-btn-block"),$("#search-03 option").remove(),void m.append("<option value='선택'> 선택 </option>");E.selectBase=$(this).val(),E.appendOptDong($(this).val())}),m.on("change",function(){E.selectDong=null,0!=$(this).children("option:selected").index()&&(E.selectDong=$(this).val(),console.log(E.selectGeoWide,E.selectBase,E.selectDong),E.fillResult(E.selectGeoWide,E.selectBase,E.selectDong))}),$("#SEARCHER_SWIFT ul li").on("click",function(e){e.preventDefault(),$("#SEARCHER_SWIFT ul li").removeClass("on"),$(this).addClass("on");var t=$(this).attr("data-search-type");_(),$(".result-text").hide(),$(".result-text-before").slideDown(),O(),"ver_dong"==t?($(".searcher-holder-ver-geo").show(),$(".searcher-holder-ver-vote").hide(),$("#SEARCHER_SWIFT .click-animation").fadeIn()):"ver_vote"==t&&($(".searcher-holder-ver-geo").hide(),$(".searcher-holder-ver-vote").show(),$("#SEARCHER_SWIFT .click-animation").hide())}),A.sort(function(e,t){return e.text>t.text?1:e.text<t.text?-1:e.value>t.value?1:e.value<t.value?-1:0}),b.html(A),b.prepend("<option value='선택'> 선택 </option>"),b.find("option").eq(0).attr("selected","selected"),E.selectGeoVote,E.selectVote,E.appendOptVote=function(e){v.find("option").remove();var t=e;for(i=0;i<full_city_vote.length;i++)full_city_vote[i].geo1==t&&v.append("<option value='"+full_city_vote[i].geo2+"'>"+full_city_vote[i].geo2+"</option>");v.removeClass("search-btn-block");var a=v.find("option");a.sort(function(e,t){return e.text>t.text?1:e.text<t.text?-1:e.value>t.value?1:e.value<t.value?-1:0}),v.html(a),v.prepend("<option value='선택'> 선택 </option>"),v.find("option").eq(0).attr("selected","selected")},E.fillResultVote=function(e,t){var a;for(i=0;i<full_city_vote.length;i++)if(full_city_vote[i].geo1==e&&full_city_vote[i].geo2==t){a=full_city_vote[i];break}$(".geo-exp").html("지역구"),$("#SELECT_CITY_NAME").html(a.geoFull),$("#SELECT_HOUSE_NUMBER").html(a.house+" 가구"),$("#SELECT_UNDERHOUSE_NUMBER").html(a.under_house+" 가구"),$("#SELECT_UNDERHOUSE_RATIO").html(a.under_house_ratio+"%"),E.showResult(a)},b.on("change",function(){if(E.selectGeoVote=null,E.selectVote=null,0==$(this).children("option:selected").index())return v.addClass("search-btn-block"),$("#search-05 option").remove(),void v.append("<option value='선택'> 선택 </option>");E.appendOptVote($(this).val()),E.selectGeoVote=$(this).val()}),v.on("change",function(){E.selectVote=null,0!=$(this).children("option:selected").index()&&(E.selectVote=$(this).val(),console.log(E.selectGeoVote,E.selectVote),E.fillResultVote(E.selectGeoVote,E.selectVote))});var w;!function(t){var a=20,l=20,r=40,o=60,n=(e<600?e:600)-o-l,s=315-a-r,i=(t=t,d3.scale.ordinal().rangeRoundBands([0,n],.3)),c=d3.scale.linear().rangeRound([s,0]),d=d3.scale.category20(),p=d3.svg.axis().scale(i).orient("bottom"),u=d3.svg.axis().scale(c).orient("left").tickFormat(d3.format(".0%")),h=d3.select("#STACKED_BAR").select("svg").attr("width",n+o+l).attr("height",s+a+r).append("g").attr("transform","translate("+o+","+a+")").attr("class","stacked-bar-holder");d.domain(d3.keys(t[0]).filter(function(e){return"houseType"!==e})),t.forEach(function(e){var t=0;e.number=d.domain().map(function(a){return console.log(),{name:a,y0:t,y1:t+=+e[a],amount:e[a]}}),e.number.forEach(function(e){e.y0/=t,e.y1/=t})}),t.sort(function(e,t){return t.number[0].y1-e.number[0].y1}),i.domain(t.map(function(e){return e.houseType})),p=h.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(p).attr("class","axis xaxis"),u=h.append("g").attr("class","y axis").call(u).attr("class","axis yaxis"),d3.selectAll(".yaxis g.tick").filter(function(e){return.5==e}).select("text").attr("class","strong");var f=h.selectAll(".houseType").data(t).enter().append("g").attr("class","houseType").attr("transform",function(e){return"translate("+i(e.houseType)+",0)"});f.selectAll("rect").data(function(e){return e.number}).enter().append("rect").attr("width",i.rangeBand()).attr("y",function(e){return c(e.y1)}).attr("height",function(e){return c(e.y0)-c(e.y1)}).style("fill",function(e){return"1명"==e.name?"#ddd":"2명"==e.name?"#b51e00":"3명"==e.name?"#fa420b":"4명"==e.name?"#ff6c40":"5명"==e.name?"#ff8c43":"6명"==e.name?"#ffc490":"7명 이상"==e.name?"#ffdfc2":void 0}),h.append("line").attr("class","half-line").attr("x1",0).attr("y1",0).attr("x2",n).attr("y2",0).attr("stroke-width","0.5").attr("stroke","#111").attr("transform","translate(0,"+s/2+")"),f.selectAll("text").data(function(e){return e.number}).enter().append("text").attr("class","stacked-label").filter(function(e,t){return t<4}).text(function(e){return e.name}).attr("transform",function(e){return"translate("+i.rangeBand()/2+","+(c(e.y1)+15)+")"})}([{houseType:"반지하가구","1명":188442,"2명":82762,"3명":49642,"4명":32050,"5명":8707,"6명":1679,"7명 이상":614},{houseType:"옥상가구","1명":31832,"2명":10112,"3명":5964,"4명":3978,"5명":1330,"6명":457,"7명 이상":159}]),function(){var e=d3.select(".map-holder").select("svg").attr("width",1e3).attr("height",700),t=(e.append("pattern").attr("id","diagonalHatch").attr("patternUnits","userSpaceOnUse").attr("width",4).attr("height",4).append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2").attr("stroke","#cf3a00").attr("stroke-width",2),e.append("pattern").attr("id","diagonalHatch2").attr("patternUnits","userSpaceOnUse").attr("width",6).attr("height",6).append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2").attr("stroke","#cf3a00").attr("stroke-width",2),e.append("pattern").attr("id","triangle").attr("patternUnits","userSpaceOnUse").attr("width",6).attr("height",6).append("path").attr("d","M5,0 10,10 0,10 Z").attr("fill","#cf3a00"),e.append("g").attr("id","map")),a=(e.append("g").attr("id","places"),t.append("g").attr("id","UNDER_HOUSE_RATIO").attr("class","map--layer")),l=t.append("g").attr("id","LOW_INCOME_RATIO").attr("class","map--layer"),r=t.append("g").attr("id","OLD_RATIO").attr("class","map--layer"),o=t.append("g").attr("id","SINGLE_PARENT_RATIO").attr("class","map--layer"),n=t.append("g").attr("id","GEO");w=t.append("g").attr("id","GEO_LABEL");var s=d3.geo.mercator().center([126.9895,37.5651]).scale(1e5).translate([500,350]),i=d3.geo.path().projection(s);d3.json("js/seoul_municipalities_topo_simple.json",function(e,t){for(var s=topojson.feature(t,t.objects.seoul_municipalities_geo).features,c=(t=t,0);c<seoul_basic.length;c++)for(var d=0;d<s.length;d++)if(seoul_basic[c].geo_code==s[d].properties.SIG_CD){s[d].properties.real_price=seoul_basic[c].real_price,s[d].properties.pop=seoul_basic[c].pop,s[d].properties.house=seoul_basic[c].house,s[d].properties.under_house=seoul_basic[c].under_house,s[d].properties.under_house_ratio=seoul_basic[c].under_house_ratio,s[d].properties.under_house_single_ratio=seoul_basic[c].under_house_single_ratio,s[d].properties.old_ratio=seoul_basic[c].old_ratio,s[d].properties.single_parent_house_ratio=seoul_basic[c].single_parent_house_ratio,s[d].properties.low_income_house_ratio=seoul_basic[c].low_income_house_ratio;break}d3.scale.category10(),d3.scale.linear().domain([2.2,11.3]).range(["rgba(255,130,38,0.05)","rgba(255,130,38,0.5)"]),d3.scale.linear().domain([8.53,29.28]).range(["rgba(255,62,38,0.01)","rgba(255,62,38,0.5)"]),d3.scale.linear().domain([.39,1.72]).range(["rgba(255,38,64,0.05)","rgba(255,38,64,0.4)"]);var p=d3.scale.linear().domain([2.32,8.85]).range(["0.1","1.0"]),u=d3.scale.linear().domain([.39,1.72]).range(["0.1","0.7"]);a.selectAll("path").data(s).enter().append("path").attr("class",function(e){return console.log(),"geo geo-under-house c-"+e.properties.SIG_CD}).attr("d",i).style("fill",function(e){return function(e){if(e<=6){if(2<e&&e<=3)return"rgba(255,130,38,0.05)";if(3<e&&e<=4)return"rgba(255,130,38,0.1)";if(4<e&&e<=6)return"rgba(255,130,38,0.15)"}else if(e>6){if(6<e&&e<=8)return"rgba(255,130,38,0.3)";if(8<e&&e<=10)return"rgba(255,130,38,0.5)";if(10<e)return"rgba(255,130,38,0.7)"}}(e.properties.under_house_ratio)}),l.selectAll("path").data(s).enter().append("path").attr("class",function(e){return console.log(),"geo geo-low-income c-"+e.properties.SIG_CD}).attr("d",i).style("fill","url(#diagonalHatch)").style("fill-opacity",function(e){var t=e.properties.low_income_house_ratio;return p(t)}).style("stroke-opacity",function(e){var t=e.properties.low_income_house_ratio;return t<5.3?"0.2":t>=5.3?"1":void 0}).style("stroke-width","2"),o.selectAll("path").data(s).enter().append("path").attr("class",function(e){return console.log(),"geo geo-single-parent c-"+e.properties.SIG_CD}).attr("d",i).style("fill","url(#diagonalHatch)").style("fill-opacity",function(e){var t=e.properties.single_parent_house_ratio;return u(t)}).style("stroke-opacity",function(e){var t=e.properties.single_parent_house_ratio;return t<.9?"0.1":t>=.9?"1":void 0}).style("stroke-width","2").style("stroke","#cf3a00"),r.selectAll("path").data(s).enter().append("path").attr("class",function(e){return console.log(),"geo geo-old c-"+e.properties.SIG_CD}).attr("d",i).style("fill",function(e){return function(e){if(e<=18.5){if(e<=12)return"rgba(255,62,38,0.01)";if(12<e&&e<=15)return"rgba(255,62,38,0.05)";if(15<e&&e<=18.5)return"rgba(255,62,38,0.1)"}else if(e>18.5){if(18.5<e&&e<=22)return"rgba(255,62,38,0.4)";if(22<e&&e<=25)return"rgba(255,62,38,0.5)";if(25<e)return"rgba(255,62,38,0.6)"}}(e.properties.old_ratio)});var h=n.selectAll("path").data(s).enter().append("path").attr("class",function(e){return console.log(),"geo geo-basic c-"+e.properties.SIG_CD}).attr("d",i),f=$(".map-holder .tooltip");h.on("mouseover",function(e){d3.select(this).style("stroke-opacity","1").style("stroke-width",2).style("stroke-dasharray",0).style("stroke-dashoffset",0),f.css("display","block"),f.find(".tooltip-con .city-name").html(e.properties.SIG_KOR_NM),f.find(".tooltip-con .under-household-ratio .value").html(e.properties.under_house_ratio+"%"),f.css({left:d3.mouse(this)[0]+"px"}),f.css({top:d3.mouse(this)[1]+10+"px"})}).on("mouseout",function(e){d3.select(this).style("stroke-opacity",null).style("stroke-width",null).style("stroke-dasharray",null).style("stroke-dashoffset",null),f.css("display","none")}),w.selectAll("text").data(s).enter().append("text").attr("transform",function(e){return"translate("+i.centroid(e)+")"}).attr("dy",".35em").attr("class","geo-label").text(function(e){return e.properties.SIG_KOR_NM})})}(),$("#UNDER_HOUSE_RATIO").hide(),$("#LOW_INCOME_RATIO").hide(),$("#SINGLE_PARENT_RATIO").hide(),$("#OLD_RATIO").hide(),$(".seoul-map .btn-holder ul").find("li").on("click",function(){$(this).index();var e=$(this).attr("data-map-type");1==$(this).hasClass("on")?($(this).removeClass("on"),"under-house"==e?$("#UNDER_HOUSE_RATIO").hide():"low-income"==e?$("#LOW_INCOME_RATIO").hide():"single-parents"==e?$("#SINGLE_PARENT_RATIO").hide():"old-low-income"==e&&$("#OLD_RATIO").hide()):($(this).addClass("on"),"under-house"==e?$("#UNDER_HOUSE_RATIO").fadeIn():"low-income"==e?$("#LOW_INCOME_RATIO").fadeIn():"single-parents"==e?$("#SINGLE_PARENT_RATIO").fadeIn():"old-low-income"==e&&$("#OLD_RATIO").fadeIn())});var T=[];seoul_basic.map(function(e,t,a){var l={};l.geo=a[t].geo,l.rent_apart=a[t].rent_apart,T.push(l)}),function(){var t=e<700?e-50:700,a=seoul_basic,r=a.map(function(e){return Number(e.rent_apart)}),o=d3.max(r),n=(d3.min(r),300/o),s=(t-10)/a.length-2,i=d3.select("#SEOUL_RENT_APART_POLE").select("svg").attr("width",t+"px").attr("height","300px"),c=i.append("g").attr("class","chart-holder"),d=(d3.scale.linear().range([0,t]),d3.scale.linear().range([300,0]).domain([0,o])),u=d3.svg.axis().scale(d).orient("left").ticks(5);c.append("g").attr("class","y axis").attr("transform","translate(-10,0)").call(u);var h=i.append("g").attr("transform","translate(0,300)").selectAll("g").data(a).enter().append("g").attr("transform",function(e,t){return"translate("+t*(s+2)+","+(1==l?15:30)+")"}).append("text").attr("width","50").attr("fill","#111").attr("font-size","10px").attr("class","graph-Xaxis").text(function(e){return e.geo});1==l?h.style("opacity",function(e){return"강서구"==e.geo||"노원구"==e.geo?"1":"0"}).attr("text-anchor","middle"):h.attr("transform","rotate(-45)").attr("text-anchor","start");var f=c.append("g").attr("class","half-line-holder").attr("transform","translate(0,"+(300-10351*n)+")"),_=(f.append("line").attr("class","half-line").attr("x1",0).attr("y1",0).attr("x2",t).attr("y2",0).attr("stroke-width","0.5").attr("stroke","#111"),1==l?"평균":"평균 10,351호");f.append("text").attr("transform","translate("+(t-5)+",0)").text(_);var g=c.append("g").attr("class","pole-rent-holder").selectAll("g").data(a).enter().append("g").attr("class","pole-g").attr("transform",function(e,t){return"translate("+t*(s+2)+",0)"});g.append("rect").style("fill",function(e){return"강서구"==e.geo||"노원구"==e.geo?"#ff5200":"#ff9c34"}).attr("width",s).attr("class","pole").attr("height",function(e){var t=Number(e.rent_apart)*n;return t<4&&(t=4),t}).attr("x",function(e,t){return 0}).attr("y",function(e){var t=Number(e.rent_apart)*n;return t<4&&(t=4),300-t}),g.append("text").filter(function(e){return"강서구"==e.geo||"노원구"==e.geo}).attr("class","pole-label").attr("transform",function(e,t){return"translate("+s/2+","+(300-Number(e.rent_apart)*n-5)+")"}).text(function(e){return p(e.rent_apart)+"호"});var y=$(".seoul-rent-apart-chart .tooltip");y.css({opacity:"0"}),1==l?(g.on("click",function(e){d3.selectAll("#SEOUL_RENT_APART_POLE .pole").style("fill-opacity","0.4"),d3.select(this).selectAll(".pole").style("fill-opacity","1").style("stroke","#7b0000").style("stroke-width","1px"),y.css({opacity:"1"}),y.find(".city-name").html(e.geo),y.find(".rent-apart .value").html(p(e.rent_apart)),1==l||(y.css({left:d3.mouse(this.parentNode)[0]+150+"px"}),y.css({bottom:"-30px"}));var t=e.geo;d3.selectAll(".graph-Xaxis").filter(function(e){return e.geo==t}).style("fill-opacity","1").style("fill","#ff5200")}).on("mouseleave",function(e){d3.selectAll("#SEOUL_RENT_APART_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),y.css({opacity:"0"}),d3.selectAll(".graph-Xaxis").style("fill-opacity",null).style("fill",null)}),$(".story-body:not(#SEOUL_RENT_APART_POLE)").on("touchstart",function(){d3.selectAll("#SEOUL_RENT_APART_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),y.css({opacity:"0"}),d3.selectAll(".graph-Xaxis").style("fill-opacity",null).style("fill",null)})):g.on("mouseenter",function(e){d3.selectAll("#SEOUL_RENT_APART_POLE .pole").style("fill-opacity","0.4"),d3.select(this).selectAll(".pole").style("fill-opacity","1").style("stroke","#7b0000").style("stroke-width","1px"),y.css({opacity:"1"}),y.find(".city-name").html(e.geo),y.find(".rent-apart .value").html(p(e.rent_apart)),1==l||(y.css({left:d3.mouse(this.parentNode)[0]+150+"px"}),y.css({bottom:"-30px"}));var t=e.geo;d3.selectAll(".graph-Xaxis").filter(function(e){return e.geo==t}).style("fill-opacity","1").style("fill","#ff5200")}).on("mouseleave",function(e){d3.selectAll("#SEOUL_RENT_APART_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),y.css({opacity:"0"}),d3.selectAll(".graph-Xaxis").style("fill-opacity",null).style("fill",null)}),$(".seoul-rent-apart-chart .tooltip .close-btn").on("click",function(){d3.selectAll("#SEOUL_RENT_APART_POLE  .pole").style("fill-opacity",null).style("stroke",null).style("stroke-width",null),y.css({opacity:"0"}),d3.selectAll(".graph-Xaxis").style("fill-opacity",null).style("fill",null)})}(),0==l&&h("only_centre");var k=(e-$(".text-box").width())/2-50;if(k>=450&&(k=450),$(".text-box").css("left",k+"px"),1==l){$(".text-box").css("left","0px"),$(".page-title").find("img").attr("src",a+"page-title-m-2.png"),$(".all-city-household-chart .pole-legend").insertAfter("#POLE_CHART_SWIFT"),$("#POLE_CHART_SWIFT").hide(),$(".wage_avr").attr("src",a+"graph_wage_avr_m.png"),$(".underhouse-wage").attr("src",a+"graph_underhouse_wage_m.png");var R=Number((e/1e3).toFixed(4))+.13,I=(4*e/15).toFixed(4);$(".seoul-map .map-holder").css({transform:"scale("+R+") translate("+-1*I+"px, 0px)","transform-origin":"left center"}),$(".all-city-household-chart .graph-des").html("막대그래프를 클릭하시면 <b>지자체별 상세정보</b>를 보실 수 있습니다."),$(".seoul-rent-apart-chart .graph-des").html("막대그래프를 클릭하시면 <b>구별 상세정보</b>를 보실 수 있습니다.")}var L={},S=null,C=$(".slider-body ul li");L.itemNumb=C.length,L.setSlider=function(){1==l?($(".gallery-slider .slider-wrapper").css({height:3*e/4+"px"}),C.css({width:$(".slider-body").width(),height:3*e/4+"px"}),S=$(".slider-body").width()):S=C.width(),$(".slider-body ul").css({width:L.itemNumb*S}),C.eq(0).addClass("slider-item-on")},L.index=0,L.moveSlide=function(e){if("prev"==e){if(0==L.index);else if(L.index>0){L.index-=1;var t=S*L.index;$(".slider-body ul").stop().animate({left:-t},500,"easeOutCubic"),C.removeClass("slider-item-on"),C.eq(L.index).addClass("slider-item-on")}}else if("next"==e)if(L.index==L.itemNumb-1);else if(L.index<L.itemNumb-1){L.index+=1;t=S*L.index;$(".slider-body ul").stop().animate({left:-t},500,"easeOutCubic"),C.removeClass("slider-item-on"),C.eq(L.index).addClass("slider-item-on")}$(".arrow").removeClass("arrow-block")},L.setSlider(),$(".arrow").on("click",function(e){$(".arrow").addClass("arrow-block"),e.preventDefault();var t=$(this).attr("id");L.moveSlide(t)}),O(),$(".loading-page").fadeOut(200,function(){for($introItem=$(".intro-fadeTo"),o=0;o<$introItem.length;o++)$introItem.eq(o).delay(700*o).animate({opacity:"1"},1500);0==l&&$(".fixed-navi").animate({right:"10px"},1e3)}),$(".close-ie-block").on("click",function(){$(".ie-block-9").hide()});var N,U="before";function D(e){N==e||N!==e&&function(e){switch(e){case 0:$(".map--layer").fadeOut(),w.selectAll("text").style("opacity","1");break;case 1:$(".map--layer").hide(),$("#OLD_RATIO").fadeIn(),w.selectAll("text").style("opacity","1");break;case 2:$(".map--layer").hide(),$("#SINGLE_PARENT_RATIO").fadeIn(),w.selectAll("text").style("opacity","1");break;case 3:$(".map--layer").hide(),$("#SINGLE_PARENT_RATIO").show(),$("#OLD_RATIO").fadeIn(),w.selectAll("text").style("opacity","0"),w.selectAll("text").filter(function(e){var t=e.properties.SIG_KOR_NM;return"강북구"==t||"중랑구"==t||"금천구"==t||"노원구"==t||"은평구"==t||"강서구"==t||"양천구"==t||"광진구"==t}).style("opacity","1");break;case 4:w.selectAll("text").style("opacity","0"),w.selectAll("text").filter(function(e){var t=e.properties.SIG_KOR_NM;return"강북구"==t||"중랑구"==t||"광진구"==t}).style("opacity","1"),w.selectAll("text").filter(function(e){var t=e.properties.SIG_KOR_NM;return"강동구"==t||"관악구"==t||"금천구"==t||"은평구"==t||"양천구"==t}).style("opacity","0.8"),w.selectAll("text").filter(function(e){var t=e.properties.SIG_KOR_NM;return"노원구"==t||"강서구"==t}).style("opacity","0.3"),$(".map--layer").hide(),$("#UNDER_HOUSE_RATIO").fadeIn();break;case 5:w.selectAll("text").style("opacity","1"),$(".map--layer").hide(),$("#UNDER_HOUSE_RATIO").show()}}(N=e)}$(".map-fixed-slider .fixed-el").css({"padding-top":(t-$(".map-holder").height())/2+"px"}),$(".map-fixed-slider").css({height:$(".map-fixed-slider").height()+t+"px"}),$(window).scroll(function(){var e=$(window).scrollTop(),a=$(".map-fixed-slider").offset().top+$(".map-fixed-slider").height()-t;e>=$(".map-fixed-slider").offset().top&&e<a?"on"!==U&&(U="on",$(".fixed-el").addClass("fixed-el-fixed"),$(".fixed-el").removeClass("fixed-el-bottom")):e<$(".map-fixed-slider").offset().top?"before"!==U&&(U="before",$(".fixed-el").removeClass("fixed-el-fixed"),$(".fixed-el").removeClass("fixed-el-bottom"),$(".map--layer").hide()):e>=a&&"after"!==U&&(U="after",$(".fixed-el").removeClass("fixed-el-fixed"),$(".fixed-el").addClass("fixed-el-bottom")),function(e){var a=$(".map-stage");if((e+=.7*t)<a.eq(0).offset().top)D(0);else if(e>=a.eq(a.length-1).offset().top)D(a.length);else if(e>=a.eq(0).offset().top&&e<a.eq(a.length-1).offset().top)for(s=0;s<a.length-1;s++)e>=a.eq(s).offset().top&&e<a.eq(s+1).offset().top&&D(s+1)}(e);var r=e/($(document).height()-$(window).height()-($(".footer-area").height()+$(".digital-list").height()+$(".common-footer").height()))*100;1==l?$(".progress").css({width:r+"%"}):$(".progress").css({height:r+"%"})})});